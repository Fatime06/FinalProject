@using Service.ViewModels.Product
@model IEnumerable<ProductVM>

<section id="best-sellers">
    <div class="best-container">

        @foreach (var product in Model)
        {
            <div class="best-card">
                <div class="best-img">
                    <img src="~/admin/uploads/products/@product.Image" alt="@product.Name">
                    <div class="product-icons">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <i class="fa-solid fa-cart-shopping"></i>
                    </div>
                </div>

                <h4>@product.Name</h4>

                <div class="stars">
                    @{
                        int fullStars = (int)product.AverageRating;
                        bool halfStar = product.AverageRating - fullStars >= 0.5;
                    }
                    @for (int i = 0; i < fullStars; i++)
                    {
                        <span>★</span>
                    }
                    @if (halfStar)
                    {
                        <span>★</span>
                    }
                    @for (int i = fullStars + (halfStar ? 1 : 0); i < 5; i++)
                    {
                        <span>☆</span>
                    }
                </div>

                <p class="price">
                    @if (product.DiscountPrice != null)
                    {
                        <span class="new">$@product.DiscountPrice</span>
                        <span class="old">$@product.Price</span>
                    }
                    else
                    {
                        <span class="new">$@product.Price</span>
                    }
                </p>

                <p class="stock @(product.InStock ? "" : "out")">
                    <i class="fa-solid fa-circle"></i>
                    @(product.InStock ? "In Stock" : "Out of Stock")
                </p>

                <div class="cart">
                    <input type="number"
                           class="add-qty"
                           value="1"
                           min="1"
                           max="@product.Quantity">
                    <button class="add-to-cart" @(product.InStock ? "" : "disabled") data-id="@product.Id">
                        ADD TO CART
                    </button>
                </div>
            </div>
        }

        <div class="best-banner-1">
            <img src="~/assets/img/Banner2.jpeg" alt="">
            <div class="banner-text-1">
                <h3>SAVE <span>$45 OFF</span><br>TOP SUMMER WINES</h3>
                <p>Hurry Up Expire Soon!</p>
                <button>SHOP NOW</button>
            </div>
        </div>

    </div>
</section>
